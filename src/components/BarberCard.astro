---
import { Image } from 'astro:assets';

export interface Props {
  name: string;
  role?: 'Barber' | 'Stylist';
  image: any;                // import from assets e.g. import juan from '../assets/juan.jpg'
  imageAlt?: string;
  rating?: number;           // 0–5
  tags?: string[];           // specialties: ["Fades", "Beards", "Color"]
  bio?: string;
  hrefProfile?: string;
  hrefBook?: string;
  isAvailable?: boolean;     // green dot when true
}

const {
  name,
  role = 'Barber',
  image,
  imageAlt = `${name}`,
  rating = 5,
  tags = [],
  bio = '',
  hrefProfile = '#',
  hrefBook = '#book',
  isAvailable = true,
} = Astro.props;

// clamp rating
const r = Math.max(0, Math.min(5, Math.round(rating)));
---

<article
  class="group relative overflow-hidden rounded-2xl border bg-[color-mix(in_oklab,var(--text)_2%,transparent)]
                 border-[var(--border)] shadow transition
                 hover:border-[color:var(--primary)] hover:shadow-[0_0_24px_color-mix(in_oklab,var(--primary)_25%,transparent)]">

  <!-- photo -->
  <div class="relative aspect-[4/3] overflow-hidden">
    <Image
      src={image}
      alt={imageAlt}
      widths={[480, 720, 960]}
      sizes="(min-width:1024px) 33vw, 100vw"
      format="webp"
      quality={85}
      class="h-full w-full object-cover transition duration-500 group-hover:scale-[1.05]"
      loading="lazy"
    />


    <!-- colored corner glow -->
    <div
      aria-hidden="true"
      class="pointer-events-none absolute -left-8 -top-8 h-24 w-24 rounded-full blur-2xl opacity-60"
      style="background: color-mix(in oklab, var(--primary) 45%, transparent)"
    ></div>
  </div>

  <!-- content -->
  <div class="p-4 sm:p-5">
    <div class="mb-1 flex items-center justify-between">
      <h3 class="text-lg font-bold tracking-tight">{name}</h3>
      <span
        class="rounded-full bg-[var(--primary)]/10 px-2.5 py-0.5 text-xs font-semibold text-[color:var(--primary)]"
      >
        {role}
      </span>
    </div>

    <!-- rating -->
    <div class="mb-3 flex items-center gap-1.5 text-[13px] text-neutral-600 dark:text-neutral-300">
      {Array.from({ length: 5 }).map((_, i) => (
        <span class={i < r ? 'text-[color:var(--primary)]' : 'opacity-30'} aria-hidden="true">★</span>
      ))}
      <span class="ml-1 opacity-70">{r}.0</span>
    </div>

    {bio && (
      <p class="mt-2 text-[color-mix(in_oklab,var(--text)_70%,transparent)]">
        {bio}
      </p>
    )}

    {tags.length > 0 && (
      <ul class="mb-4 flex flex-wrap gap-2">
        {tags.map(t => (
          <li
            class="rounded-full border border-[var(--border)] bg-[var(--surface)]
                   px-2.5 py-1 text-xs font-medium text-[var(--text)]/80"
          >
            {t}
          </li>
        ))}
      </ul>
    )}

    <!-- actions -->
    <div class="mt-auto flex gap-2">
      <a
        href={hrefBook}
        class="relative inline-flex flex-1 items-center justify-center rounded-lg px-3.5 py-2.5
               text-sm font-semibold text-white shadow-sm transition
               hover:-translate-y-0.5 focus:outline-none focus:ring-2
               focus:ring-[color:var(--primary)]/70 focus:ring-offset-2 focus:ring-offset-[var(--surface)]"
        style="background: var(--primary); box-shadow: 0 6px 18px color-mix(in oklab, var(--primary) 35%, transparent);"
      >
        Book
        <!-- shine -->
        <span
          aria-hidden="true"
          class="pointer-events-none absolute inset-0 -translate-x-full
                 bg-[linear-gradient(120deg,transparent,rgba(255,255,255,0.20),transparent)]
                 transition-transform duration-700 ease-out group-hover:translate-x-full"
        ></span>
      </a>
      </a>
    </div>
  </div>
</article>
